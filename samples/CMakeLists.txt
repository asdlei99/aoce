
set(targets findmodule)
set(targetopencvs showdevice)

SET(OpenCV_DIR D:/WorkSpace/C++/opencv/opencv41/build/install)
find_package(OpenCV)   
message(STATUS "OpenCV library status:")
message(STATUS "    found: ${OpenCV_FOUND}")
message(STATUS "    version: ${OpenCV_VERSION}")
message(STATUS "    version: ${OpenCV_VERSION}")
message(STATUS "    libraries: ${OpenCV_LIBS}")
message(STATUS "    librarie path: ${OpenCV_LIB_PATH}")
message(STATUS "    include path: ${OpenCV_INCLUDE_DIRS}")

function(generate target isopencv)
    set(source ${target}/${target}.cpp)
    add_executable(${target} ${source})
    # target_link_options(${target} PRIVATE -mwindows)
    if(isopencv)
        target_link_libraries(${target} aoce)
    else()
        target_link_directories(${target} ${OpenCV_LIB_PATH})
        target_link_libraries(${target} aoce ${OpenCV_LIBS})
    endif()
    aoce_output(${target})
endfunction(generate target)

function(sample)
    foreach(target ${targets})
        generate(${target} FALSE)
    endforeach()
    if(OpenCV_FOUND)
        foreach(target ${targetopencvs})
            generate(${target} TRUE)
        endforeach()    
    endif()
endfunction(sample)

sample()
include_directories(${AOCE_HEADER_DIR} ${OpenCV_INCLUDE_DIRS})
